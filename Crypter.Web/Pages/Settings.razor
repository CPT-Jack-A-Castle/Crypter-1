@page "/user/settings"

@inherits SettingsBase

<div class="container-sm my-4">
   @if (!Loading)
   {
      <h1>Settings</h1>
      <form id="publicDetailsForm">
         <h2>Public Details</h2>
         <div class="mb-3">
            <label for="publicUrl">Profile Link</label>
            <div class="copiedTooltip">
               <div class="input-group mb-3">
                  <input @bind="ProfileUrl" class="form-control" type="url" id="publicUrl" disabled @onclick="CopyToClipboard" />
                  <div class="input-group-append">
                     <button class="btn btn-secondary" type="button" @onclick="CopyToClipboard">Copy</button>
                  </div>
               </div>
               <span class="copiedToolTip toolTipText">Copied</span>
            </div>
         </div>
         <div class="mb-3">
            <label for="aliasFormControl" class="form-label">Alias</label>
            <input @bind="EditedAlias" type="text" class="form-control" id="aliasFormControl" placeholder="Alias Not Set" readonly="@(!AreProfileControlsEnabled)" />
         </div>
         <div class="mb-3">
            <label for="aboutFormControl" class="form-label">About</label>
            <textarea @bind="EditedAbout" type="text" class="form-control" id="aboutFormControl" placeholder="Write something about yourself" readonly="@(!AreProfileControlsEnabled)"></textarea>
         </div>
         <button type="button" class="btn btn-secondary mx-auto" @onclick="OnEditProfileInfoClicked" hidden="@IsEditing">Edit Profile</button>
         <button type="button" class="btn btn-secondary mx-auto" @onclick="OnCancelProfileInfoClicked" hidden="@(!AreProfileControlsEnabled)">Cancel</button>
         <button type="button" class="btn btn-primary mx-auto" @onclick="OnSaveProfileInfoClickedAsync" hidden="@(!AreProfileControlsEnabled)">Save Profile</button>
      </form>
      <form>
         <h2>Contact Information</h2>
         <div class="mb-3">
            <label for="emailFormControl" class="form-label">Email Address</label>
            <input @bind="EditedEmail" type="email" class="form-control" id="emailFormControl" placeholder="Email Not Set" readonly="@(!AreContactInfoControlsEnabled)" />
         </div>
         <div class="mb-3" hidden="@(!AreContactInfoControlsEnabled)">
            <label for="currentPasswordForContactInfoFormControl" class="form-label">Current Password</label>
            <input @bind="CurrentPasswordForContactInfo" type="password" class="form-control" id="currentPasswordForContactInfoFormControl" />
         </div>
         <button type="button" class="btn btn-secondary mx-auto" @onclick="OnEditContactInfoClicked" hidden="@IsEditing">Edit Contact Info</button>
         <button type="button" class="btn btn-secondary mx-auto" @onclick="OnCancelContactInfoClicked" hidden="@(!AreContactInfoControlsEnabled)">Cancel</button>
         <button type="button" class="btn btn-primary mx-auto" @onclick="OnSaveContactInfoClickedAsync" hidden="@(!AreContactInfoControlsEnabled)">Save Contact Info</button>
      </form>
         <!--
            <form>
               <h2>Password</h2>
               <div class="mb-3">
                  <label for="newPasswordFormControl" class="form-label">Password</label>
                  <input @bind="NewPassword" type="password" class="form-control" id="newPasswordFormControl" placeholder="Hidden" readonly="@(!ArePasswordControlsEnabled)" />
               </div>
               <div class="mb-3" hidden="@(!ArePasswordControlsEnabled)">
                  <label for="currentPasswordForPasswordChangeFormControl" class="form-label">Current Password</label>
                  <input @bind="CurrentPasswordForPasswordSection" type="password" class="form-control" id="currentPasswordForPasswordChangeFormControl" />
               </div>
               <button type="button" class="btn btn-secondary mx-auto" @onclick="OnEditPasswordClicked" hidden="@IsEditing">Edit Password</button>
               <button type="button" class="btn btn-secondary mx-auto" @onclick="OnCancelPasswordClicked" hidden="@(!ArePasswordControlsEnabled)">Cancel</button>
               <button type="button" class="btn btn-primary mx-auto" @onclick="OnSavePasswordClickedAsync" hidden="@(!ArePasswordControlsEnabled)">Save Password</button>
            </form>
         -->
      <form>
         <h2>Privacy Settings</h2>
         <div class="mb-3">
            <div class="form-check form-switch">
               <label class="form-check-label" for="allowKeyExchangeRequests">Allow contacts to request key exchange</label>
               <input @bind="EditedAllowKeyExchangeRequests" class="form-check-input" type="checkbox" id="allowKeyExchangeRequests" disabled="@(!ArePrivacyControlsEnabled)" />
            </div>
         </div>
         <div>
            <label class="form-label h5" for="profileVisibilityFormControl">Who can see your profile</label>
            <input @bind="EditedVisibility" type="range" class="form-range" id="profileVisibilityFormControl" min="@((int)UserVisibilityLevel.None)" max="@((int)UserVisibilityLevel.Everyone)" step="1.0" disabled="@(!ArePrivacyControlsEnabled)" />
            <div class="row">
               <div class="col-2">
                  <p class="text-start">Nobody</p>
               </div>
               <div class="col-4">
                  <p class="text-center">My contacts</p>
               </div>
               <div class="col-4">
                  <p class="text-center">Crypter users</p>
               </div>
               <div class="col-2">
                  <p class="text-end">Everyone</p>
               </div>
            </div>
         </div>
         <div class="mb-3">
            <label class="form-label h5" for="messageTransferPermissionControl">Who can send you messages</label>
            <input @bind="EditedMessageTransferPermission" type="range" class="form-range" id="messageTransferPermissionControl" min="@((int)UserItemTransferPermission.None)" max="@((int)UserItemTransferPermission.Everyone)" step="1.0" disabled="@(!ArePrivacyControlsEnabled)" />
            <div class="row">
               <div class="col-1">
                  <p class="text-start">Nobody</p>
               </div>
               <div class="col-3">
                  <p class="text-end">Confirmed key exchanges</p>
               </div>
               <div class="col-4">
                  <p class="text-center">My contacts</p>
               </div>
               <div class="col-2">
                  <p class="text-center">Crypter users</p>
               </div>
               <div class="col-2">
                  <p class="text-end">Everyone</p>
               </div>
            </div>
         </div>
         <div class="mb-3">
            <label class="form-label h5" for="fileTransferPermissionControl">Who can send you files</label>
            <input @bind="EditedFileTransferPermission" type="range" class="form-range" id="fileTransferPermissionControl" min="@((int)UserItemTransferPermission.None)" max="@((int)UserItemTransferPermission.Everyone)" step="1.0" disabled="@(!ArePrivacyControlsEnabled)" />
            <div class="row">
               <div class="col-1">
                  <p class="text-start">Nobody</p>
               </div>
               <div class="col-3">
                  <p class="text-end">Confirmed key exchanges</p>
               </div>
               <div class="col-4">
                  <p class="text-center">My contacts</p>
               </div>
               <div class="col-2">
                  <p class="text-center">Crypter users</p>
               </div>
               <div class="col-2">
                  <p class="text-end">Everyone</p>
               </div>
            </div>
         </div>
         <button type="button" class="btn btn-secondary mx-auto" @onclick="OnEditPrivacyClicked" hidden="@IsEditing">Edit Privacy</button>
         <button type="button" class="btn btn-secondary mx-auto" @onclick="OnCancelPrivacyClicked" hidden="@(!ArePrivacyControlsEnabled)">Cancel</button>
         <button type="button" class="btn btn-primary mx-auto" @onclick="OnSavePrivacyClickedAsync" hidden="@(!ArePrivacyControlsEnabled)">Save Privacy</button>
      </form>
      <h2>Keys</h2>
      <div class="mb-3">
         <label for="privateKey" class="form-label">X25519 - Private Key</label>
         <textarea @bind="X25519PrivateKey" class="form-control" id="x25519PrivateKey" disabled />
      </div>
      <div class="mb-3">
         <label for="privateKey" class="form-label">Ed25519 - Private Key</label>
         <textarea @bind="Ed25519PrivateKey" class="form-control" id="ed25519PrivateKey" disabled />
      </div>
   }
</div>
